---
type RatingLabel =
  | "Outstanding"
  | "Good"
  | "Adequate"
  | "Needs Improvement"
  | "Unacceptable"
  | "No Rating";

type RatingStyle = {
  color: string;
};

type Props = {
  rating: number | null;
};

const { rating } = Astro.props;

const getRatingLabel = (value: number): RatingLabel => {
  if (value >= 4.5) return "Outstanding";
  if (value >= 3.5) return "Good";
  if (value >= 2.5) return "Adequate";
  if (value >= 1.5) return "Needs Improvement";
  return "Unacceptable";
};

const ratingStyles: Record<RatingLabel, RatingStyle> = {
  Outstanding: { color: "#b45309" },
  Good: { color: "#22c55e" },
  Adequate: { color: "#8E9196" },
  "Needs Improvement": { color: "#f59e0b" },
  Unacceptable: { color: "#ef4444" },
  "No Rating": { color: "#e5e7eb" },
};

const ratingLabel: RatingLabel =
  typeof rating === "number" && Number.isFinite(rating)
    ? getRatingLabel(rating)
    : "No Rating";

const style = ratingStyles[ratingLabel];
const textColor =
  ratingLabel === "Adequate" ||
  ratingLabel === "No Rating" ||
  ratingLabel === "Needs Improvement" ||
  ratingLabel === "Unacceptable"
    ? "#111827"
    : "#ffffff";

const ratingIcons: Record<RatingLabel, string> = {
  Outstanding: `
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor" class="bi bi-award-fill" aria-hidden="true">
      <path d="m9.669.864 1.58 3.197 3.522.512a.5.5 0 0 1 .277.853l-2.55 2.486.602 3.507a.5.5 0 0 1-.725.526L8 11.187l-3.155 1.658a.5.5 0 0 1-.725-.526l.602-3.507-2.55-2.486a.5.5 0 0 1 .277-.853l3.522-.512 1.58-3.197a.5.5 0 0 1 .898 0"/>
      <path d="M4.414 12.54a1 1 0 0 0 .354 1.388l3.02 1.51a1 1 0 0 0 .894 0l3.02-1.51a1 1 0 0 0 .354-1.388l-.775-1.553-1.572.826a2.5 2.5 0 0 1-2.318 0l-1.572-.826z"/>
    </svg>
  `,
  Good: `
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor" class="bi bi-hand-thumbs-up-fill" aria-hidden="true">
      <path d="M6.956 1.745C7.021.81 7.908.087 8.864.325l.261.066c.463.116.874.456 1.012.965.22.819.361 1.733.297 2.58-.023.303-.095.616-.188.92h2.478c.967 0 1.808.653 1.926 1.603.08.654-.104 1.314-.527 1.747.16.477.17 1.033-.07 1.582a1.9 1.9 0 0 1-.866.923c.046.52-.096 1.1-.43 1.5a1.9 1.9 0 0 1-1.625.711H9.776c-.242 0-.461-.056-.642-.162l-1.16-.679c-.338-.198-.702-.426-1.074-.647a9.2 9.2 0 0 0-1.47-.823.5.5 0 0 1-.276-.447V3.377c0-.223.11-.418.3-.53z"/>
      <path d="M2.273 5.845a1.5 1.5 0 0 1 1.5-1.5h.676v7.922h-.676a1.5 1.5 0 0 1-1.5-1.5z"/>
    </svg>
  `,
  Adequate: `
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor" class="bi bi-dash-circle-fill" aria-hidden="true">
      <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M4.5 7.5a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1z"/>
    </svg>
  `,
  "Needs Improvement": `
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor" class="bi bi-hand-thumbs-down-fill" aria-hidden="true">
      <path d="M6.956 14.534c.065.936.952 1.659 1.908 1.421l.261-.065a1.378 1.378 0 0 0 1.012-.965c.22-.819.361-1.733.297-2.58-.023-.303-.095-.616-.188-.92h2.478c.967 0 1.808-.653 1.926-1.603.08-.654-.104-1.314-.527-1.747.16-.477.17-1.033-.07-1.582a1.9 1.9 0 0 0-.866-.923c.046-.52-.096-1.1-.43-1.5a1.9 1.9 0 0 0-1.625-.711H9.776c-.242 0-.461.056-.642.162l-1.16.679c-.338.198-.702.426-1.074.647a9.2 9.2 0 0 1-1.47.823.5.5 0 0 0-.276.447v7.046c0 .223.11.418.3.53z"/>
      <path d="M2.273 10.434a1.5 1.5 0 0 0 1.5 1.5h.676V3.012h-.676a1.5 1.5 0 0 0-1.5 1.5z"/>
    </svg>
  `,
  Unacceptable: `
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor" class="bi bi-x-circle-fill" aria-hidden="true">
      <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M4.646 4.646a.5.5 0 0 0 0 .708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646a.5.5 0 0 0-.708 0"/>
    </svg>
  `,
  "No Rating": `
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="currentColor" class="bi bi-slash-circle-fill" aria-hidden="true">
      <path d="M16 8A8 8 0 0 1 1.173 11.16l9.987-9.987A8 8 0 0 1 16 8M14.827 4.84 4.84 14.827A8 8 0 0 0 14.827 4.84M1.173 11.16 11.16 1.173A8 8 0 0 0 1.173 11.16"/>
    </svg>
  `,
};
---

<span
  class="badge border rounded-pill d-inline-flex align-items-center gap-2"
  style={`background-color: ${style.color}; border-color: ${style.color}; color: ${textColor};`}
>
  <span set:html={ratingIcons[ratingLabel]} />
  <span>{ratingLabel}</span>
</span>
